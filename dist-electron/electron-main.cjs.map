{"version":3,"sources":["../electron-main.ts","../src/main/database.ts","../src/main/ipc-handlers.ts","../src/main/ai-service.ts","../src/main/scraper-service.ts","../src/main/features/Hunter-engine.ts","../src/main/features/doc-generator.ts","../src/main/features/scheduler.ts"],"sourcesContent":["import { app, BrowserWindow, Menu, MenuItem } from 'electron';\r\nimport path from 'path';\r\nimport isDev from 'electron-is-dev';\r\nimport { initializeDatabase } from './src/main/database';\r\nimport { setupIpcHandlers } from './src/main/ipc-handlers';\r\n\r\n// FIX: Resolve GPU process crashes on Windows\r\napp.disableHardwareAcceleration();\r\n\r\n// FIX: Prevent multiple instances\r\nconst gotTheLock = app.requestSingleInstanceLock();\r\nif (!gotTheLock) {\r\n  app.quit();\r\n}\r\n\r\nlet mainWindow: BrowserWindow | null = null;\r\n\r\nfunction createWindow() {\r\n  mainWindow = new BrowserWindow({\r\n    width: 1400,\r\n    height: 900,\r\n    minWidth: 1000,\r\n    minHeight: 700,\r\n    webPreferences: {\r\n      preload: path.join(__dirname, \"preload.cjs\"),\r\n      contextIsolation: true,\r\n      nodeIntegration: false\r\n    },\r\n  });\r\n\r\n  const startUrl = isDev ? 'http://localhost:5173' : `file://${path.join(__dirname, '../dist/index.html')}`;\r\n  mainWindow.loadURL(startUrl);\r\n\r\n  if (isDev) mainWindow.webContents.openDevTools();\r\n\r\n  mainWindow.webContents.on('context-menu', (event, params) => {\r\n    const menu = new Menu();\r\n    menu.append(new MenuItem({ label: 'Cut', role: 'cut', enabled: params.editFlags.canCut }));\r\n    menu.append(new MenuItem({ label: 'Copy', role: 'copy', enabled: params.editFlags.canCopy }));\r\n    menu.append(new MenuItem({ label: 'Paste', role: 'paste', enabled: params.editFlags.canPaste }));\r\n    menu.append(new MenuItem({ type: 'separator' }));\r\n    menu.append(new MenuItem({ label: 'Select All', role: 'selectAll', enabled: params.editFlags.canSelectAll }));\r\n    menu.popup({ window: mainWindow! });\r\n  });\r\n\r\n  mainWindow.on('closed', () => { mainWindow = null; });\r\n}\r\n\r\napp.on('ready', async () => {\r\n  await initializeDatabase();\r\n  setupIpcHandlers();\r\n  createWindow();\r\n});\r\n\r\napp.on('window-all-closed', () => { if (process.platform !== 'darwin') app.quit(); });\r\n\r\napp.on('second-instance', () => {\r\n  if (mainWindow) {\r\n    if (mainWindow.isMinimized()) mainWindow.restore();\r\n    mainWindow.focus();\r\n  }\r\n});","import path from 'path';\r\nimport { app } from 'electron';\r\nimport fs from 'fs';\r\n\r\nlet dbData: any = (global as any).dbData || null;\r\n\r\nconst getDbPath = () => {\r\n  const dataDir = path.join(app.getPath('userData'), 'data');\r\n  if (!fs.existsSync(dataDir)) fs.mkdirSync(dataDir, { recursive: true });\r\n  return path.join(dataDir, 'db.json');\r\n};\r\n\r\nexport function getDatabase(): any {\r\n  if (!dbData) {\r\n    const dbPath = getDbPath();\r\n    if (fs.existsSync(dbPath)) {\r\n      try { dbData = JSON.parse(fs.readFileSync(dbPath, 'utf8')); } \r\n      catch (e) { dbData = getDefaultData(); }\r\n    } else { dbData = getDefaultData(); }\r\n    (global as any).dbData = dbData;\r\n  }\r\n  const tables = ['user_profile', 'email_config', 'job_preferences', 'ai_models', 'job_websites', 'company_monitoring', 'job_listings', 'applications', 'action_logs', 'email_alerts', 'documents', 'search_profiles', 'settings', 'questions'];\r\n  tables.forEach(t => { if (!dbData[t]) dbData[t] = []; });\r\n  return dbData;\r\n}\r\n\r\nconst getDefaultData = () => ({\r\n  user_profile: [], email_config: [], job_preferences: [], ai_models: [],\r\n  job_websites: [], company_monitoring: [], job_listings: [],\r\n  applications: [], action_logs: [], email_alerts: [],\r\n  documents: [], search_profiles: [], settings: [], questions: []\r\n});\r\n\r\nconst saveDb = () => {\r\n  try {\r\n    fs.writeFileSync(getDbPath(), JSON.stringify(dbData, null, 2));\r\n    console.log('DB: Saved to disk');\r\n  } catch (e) {\r\n    console.error('DB: Save failed', e);\r\n  }\r\n};\r\n\r\nexport async function initializeDatabase(): Promise<void> { getDatabase(); }\r\n\r\nconst toSnakeCase = (str: string) => str.replace(/[A-Z]/g, letter => `_${letter.toLowerCase()}`);\r\n\r\nconst mapToSnakeCase = (obj: any) => {\r\n  const newObj: any = {};\r\n  for (const key in obj) { \r\n    newObj[toSnakeCase(key)] = obj[key]; \r\n  }\r\n  return newObj;\r\n};\r\n\r\nexport async function runQuery(sql: string, params: any = []): Promise<any> {\r\n  const db = getDatabase();\r\n  \r\n  // Parse SQL to get operation and table\r\n  const sqlUpper = sql.toUpperCase();\r\n  const sqlParts = sql.trim().split(/\\s+/);\r\n  \r\n  let table = '';\r\n  if (sqlUpper.includes('INSERT INTO')) {\r\n    table = sqlParts[2];\r\n  } else if (sqlUpper.includes('UPDATE')) {\r\n    table = sqlParts[1];\r\n  } else if (sqlUpper.includes('DELETE FROM')) {\r\n    table = sqlParts[2];\r\n  }\r\n  table = table.replace(/[`\"']/g, '');\r\n  \r\n  console.log(`DB: ${sqlUpper.split(' ')[0]} on \"${table}\"`);\r\n  \r\n  if (!db[table]) {\r\n    console.log(`DB: Table \"${table}\" not found!`);\r\n    return { success: false, error: 'Table not found' };\r\n  }\r\n  \r\n  // Get data from params\r\n  const newData = Array.isArray(params) ? params[0] : params;\r\n  \r\n  // INSERT\r\n  if (sqlUpper.includes('INSERT')) {\r\n    const mapped = mapToSnakeCase(newData);\r\n    \r\n    // USE THE PROVIDED ID if it exists, otherwise generate one\r\n    const recordId = mapped.id || newData.id || Date.now();\r\n    \r\n    const record = { \r\n      ...mapped, \r\n      id: recordId,\r\n      is_active: mapped.is_active ?? 1, \r\n      timestamp: new Date().toISOString() \r\n    };\r\n    \r\n    db[table].push(record);\r\n    saveDb();\r\n    \r\n    console.log(`DB: Inserted into ${table} with id=${recordId}`);\r\n    return { id: recordId, success: true };\r\n  } \r\n  \r\n  // UPDATE\r\n  else if (sqlUpper.includes('UPDATE')) {\r\n    const mapped = mapToSnakeCase(newData);\r\n    const updateId = mapped.id || newData.id;\r\n    \r\n    console.log(`DB: Looking for id=${updateId} in ${table} (${db[table].length} records)`);\r\n    \r\n    // Find by ID\r\n    let index = -1;\r\n    if (updateId !== undefined) {\r\n      index = db[table].findIndex((item: any) => {\r\n        // Compare as numbers and strings\r\n        return item.id === updateId || \r\n               item.id === Number(updateId) || \r\n               String(item.id) === String(updateId);\r\n      });\r\n    }\r\n    \r\n    // Special case for single-record tables\r\n    if (index === -1 && ['user_profile', 'settings', 'job_preferences', 'email_config'].includes(table)) {\r\n      if (db[table].length > 0) {\r\n        index = 0;\r\n      } else {\r\n        // Create new record for single-record tables\r\n        const record = { ...mapped, id: updateId || Date.now(), timestamp: new Date().toISOString() };\r\n        db[table].push(record);\r\n        saveDb();\r\n        console.log(`DB: Created new ${table} record`);\r\n        return { id: record.id, success: true };\r\n      }\r\n    }\r\n    \r\n    if (index !== -1) {\r\n      // Merge existing data with new data\r\n      db[table][index] = { \r\n        ...db[table][index], \r\n        ...mapped,\r\n        id: db[table][index].id // Keep original ID\r\n      };\r\n      saveDb();\r\n      console.log(`DB: Updated ${table}[${index}] with id=${db[table][index].id}`);\r\n      return { success: true, id: db[table][index].id };\r\n    } else {\r\n      console.log(`DB: ‚ùå Record not found for update! id=${updateId}`);\r\n      console.log(`DB: Available IDs in ${table}:`, db[table].map((r: any) => r.id));\r\n      return { success: false, error: 'Record not found' };\r\n    }\r\n  } \r\n  \r\n  // DELETE\r\n  else if (sqlUpper.includes('DELETE')) {\r\n    const deleteId = typeof newData === 'object' ? (newData.id) : newData;\r\n    const beforeCount = db[table].length;\r\n    \r\n    db[table] = db[table].filter((item: any) => {\r\n      return item.id !== deleteId && \r\n             item.id !== Number(deleteId) && \r\n             String(item.id) !== String(deleteId);\r\n    });\r\n    \r\n    const deleted = beforeCount - db[table].length;\r\n    saveDb();\r\n    console.log(`DB: Deleted ${deleted} record(s) from ${table} where id=${deleteId}`);\r\n    return { success: true, deleted };\r\n  }\r\n  \r\n  return { success: false, error: 'Unknown operation' };\r\n}\r\n\r\nexport async function getAllQuery(sql: string): Promise<any[]> {\r\n  const db = getDatabase();\r\n  const parts = sql.trim().split(/\\s+/);\r\n  \r\n  // Handle \"SELECT * FROM table\"\r\n  let table = '';\r\n  const fromIndex = parts.findIndex(p => p.toUpperCase() === 'FROM');\r\n  if (fromIndex !== -1 && parts[fromIndex + 1]) {\r\n    table = parts[fromIndex + 1].replace(/[`\"']/g, '');\r\n  }\r\n  \r\n  const result = db[table] || [];\r\n  console.log(`DB: SELECT from ${table} returned ${result.length} records`);\r\n  return result;\r\n}\r\n\r\nexport async function logAction(userId: number, type: string, desc: string, status: string, success?: boolean) {\r\n  const db = getDatabase();\r\n  const logEntry = { \r\n    id: Date.now(),\r\n    user_id: userId, \r\n    action_type: type, \r\n    action_description: desc, \r\n    status: status, \r\n    success: success,\r\n    timestamp: new Date().toISOString()\r\n  };\r\n  \r\n  db.action_logs.push(logEntry);\r\n  \r\n  // Keep only last 200 logs\r\n  if (db.action_logs.length > 200) {\r\n    db.action_logs = db.action_logs.slice(-200);\r\n  }\r\n  \r\n  saveDb();\r\n}","import { runQuery, getAllQuery } from './database';\r\nimport { ipcMain } from 'electron';\r\nimport * as aiService from './ai-service';\r\nimport axios from 'axios';\r\n\r\nexport function setupIpcHandlers(): void {\r\n  // CLEAN SLATE: Remove ALL existing handlers to prevent \"second handler\" error\r\n  const channels = [\r\n    'settings:get', 'settings:update', 'user:get-profile', \r\n    'profiles:get-all', 'profiles:save', 'profiles:update',\r\n    'jobs:get-all', 'jobs:delete', 'jobs:add-manual', 'jobs:update-doc-confirmation',\r\n    'hunter:start-search', 'ai:process-application', 'ai:generate-tailored-docs',\r\n    'ai:fetch-models',\r\n    'docs:get-all', 'docs:save', 'docs:open-file',\r\n    'websites:get-all', 'websites:add', 'websites:delete',\r\n    'ai-models:get-all', 'ai-models:add', 'ai-models:update', 'ai-models:delete',\r\n    'logs:get-recent-actions', 'apps:get-all'\r\n  ];\r\n  \r\n  // Remove handlers first - prevents duplication on hot reload\r\n  channels.forEach(channel => {\r\n    try { ipcMain.removeHandler(channel); } catch (e) { /* ignore if not exists */ }\r\n  });\r\n\r\n  // --- SETTINGS ---\r\n  ipcMain.handle('settings:get', async () => {\r\n    try {\r\n      const data = await getAllQuery('SELECT * FROM settings');\r\n      return { success: true, data: data[0] || null };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  ipcMain.handle('settings:update', async (_, data) => {\r\n    try {\r\n      await runQuery('UPDATE settings', data);\r\n      return { success: true };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  // --- USER PROFILE ---\r\n  ipcMain.handle('user:get-profile', async () => {\r\n    try {\r\n      const data = await getAllQuery('SELECT * FROM user_profile');\r\n      return { success: true, data: data[0] || null };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  // --- SEARCH PROFILES ---\r\n  ipcMain.handle('profiles:get-all', async () => {\r\n    try {\r\n      const data = await getAllQuery('SELECT * FROM search_profiles');\r\n      return { success: true, data };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  ipcMain.handle('profiles:save', async (_, data) => {\r\n    try {\r\n      const result = await runQuery('INSERT INTO search_profiles', [data]);\r\n      return { success: true, id: result.id };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  ipcMain.handle('profiles:update', async (_, data) => {\r\n    try {\r\n      await runQuery('UPDATE search_profiles', data);\r\n      return { success: true };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  // --- JOBS ---\r\n  ipcMain.handle('jobs:get-all', async () => {\r\n    try {\r\n      const data = await getAllQuery('SELECT * FROM job_listings');\r\n      return { success: true, data };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  ipcMain.handle('jobs:delete', async (_, id) => {\r\n    try {\r\n      const deleteId = typeof id === 'object' ? id.id : id;\r\n      await runQuery('DELETE FROM job_listings', { id: deleteId });\r\n      return { success: true };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  ipcMain.handle('jobs:add-manual', async (_, data) => {\r\n    try {\r\n      const result = await runQuery('INSERT INTO job_listings', { \r\n        ...data, \r\n        source: 'Manual', \r\n        status: 'analyzing' \r\n      });\r\n      // Start analysis in background\r\n      aiService.analyzeJobUrl(result.id, data.userId, data.url).catch(console.error);\r\n      return { success: true, id: result.id };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  ipcMain.handle('jobs:update-doc-confirmation', async (_, data) => {\r\n    try {\r\n      await runQuery('UPDATE job_listings', { \r\n        id: data.jobId, \r\n        user_confirmed_docs: data.confirmed \r\n      });\r\n      return { success: true };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  // --- AI / HUNTER ---\r\n  ipcMain.handle('hunter:start-search', async (_, userId) => {\r\n    try {\r\n      const result = await aiService.startHunterSearch(userId);\r\n      return result;\r\n    } catch (e: any) {\r\n      console.error('Hunter search error:', e);\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  ipcMain.handle('ai:process-application', async (_, jobId, userId) => {\r\n    try {\r\n      return await aiService.processApplication(jobId, userId);\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  ipcMain.handle('ai:generate-tailored-docs', async (_, data) => {\r\n    try {\r\n      return await aiService.processApplication(data.jobId, data.userId);\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  // --- AI FETCH MODELS (NEW) ---\r\n  ipcMain.handle('ai:fetch-models', async (_, data) => {\r\n    try {\r\n      const { provider, apiKey } = data;\r\n      let models: string[] = [];\r\n\r\n      if (provider === 'openai') {\r\n        const response = await axios.get('https://api.openai.com/v1/models', {\r\n          headers: { 'Authorization': `Bearer ${apiKey}` },\r\n          timeout: 10000\r\n        });\r\n        models = response.data.data\r\n          .filter((m: any) => m.id.includes('gpt'))\r\n          .map((m: any) => m.id)\r\n          .sort();\r\n      } else if (provider === 'together') {\r\n        // Together AI models\r\n        models = [\r\n          'mistralai/Mixtral-8x7B-Instruct-v0.1',\r\n          'meta-llama/Llama-3-70b-chat-hf',\r\n          'meta-llama/Llama-3-8b-chat-hf',\r\n          'togethercomputer/CodeLlama-34b-Instruct'\r\n        ];\r\n      } else if (provider === 'local') {\r\n        // Try to fetch from Ollama\r\n        try {\r\n          const response = await axios.get('http://localhost:11434/api/tags', { timeout: 5000 });\r\n          models = response.data.models?.map((m: any) => m.name) || ['llama3', 'mistral', 'codellama'];\r\n        } catch {\r\n          models = ['llama3', 'mistral', 'codellama', 'phi3'];\r\n        }\r\n      }\r\n\r\n      return { success: true, models };\r\n    } catch (e: any) {\r\n      console.error('Fetch models error:', e.message);\r\n      return { success: false, error: e.message, models: [] };\r\n    }\r\n  });\r\n\r\n  // --- DOCUMENTS ---\r\n  ipcMain.handle('docs:get-all', async () => {\r\n    try {\r\n      const data = await getAllQuery('SELECT * FROM documents');\r\n      return { success: true, data };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  ipcMain.handle('docs:save', async (_, data) => {\r\n    try {\r\n      const result = await runQuery('INSERT INTO documents', [data]);\r\n      return { success: true, id: result.id };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  ipcMain.handle('docs:open-file', async (_, filePath) => {\r\n    try {\r\n      const { shell } = require('electron');\r\n      await shell.openPath(filePath);\r\n      return { success: true };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  // --- WEBSITES ---\r\n  ipcMain.handle('websites:get-all', async () => {\r\n    try {\r\n      const data = await getAllQuery('SELECT * FROM job_websites');\r\n      return { success: true, data };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  ipcMain.handle('websites:add', async (_, data) => {\r\n    try {\r\n      const result = await runQuery('INSERT INTO job_websites', [data]);\r\n      return { success: true, id: result.id };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  ipcMain.handle('websites:delete', async (_, id) => {\r\n    try {\r\n      await runQuery('DELETE FROM job_websites', { id });\r\n      return { success: true };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  // --- AI MODELS ---\r\n  ipcMain.handle('ai-models:get-all', async () => {\r\n    try {\r\n      const data = await getAllQuery('SELECT * FROM ai_models');\r\n      return { success: true, data };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  ipcMain.handle('ai-models:add', async (_, data) => {\r\n    try {\r\n      const result = await runQuery('INSERT INTO ai_models', [data]);\r\n      return { success: true, id: result.id };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  ipcMain.handle('ai-models:update', async (_, data) => {\r\n    try {\r\n      await runQuery('UPDATE ai_models', [data]);\r\n      return { success: true };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  ipcMain.handle('ai-models:delete', async (_, id) => {\r\n    try {\r\n      await runQuery('DELETE FROM ai_models', { id });\r\n      return { success: true };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  // --- LOGS ---\r\n  ipcMain.handle('logs:get-recent-actions', async () => {\r\n    try {\r\n      const data = await getAllQuery('SELECT * FROM action_logs');\r\n      return { success: true, data };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  // --- APPLICATIONS ---\r\n  ipcMain.handle('apps:get-all', async () => {\r\n    try {\r\n      const data = await getAllQuery('SELECT * FROM applications');\r\n      return { success: true, data };\r\n    } catch (e: any) {\r\n      return { success: false, error: e.message };\r\n    }\r\n  });\r\n\r\n  // Start scheduler\r\n  aiService.startHuntingScheduler(1);\r\n  \r\n  console.log('‚úÖ IPC Handlers registered successfully');\r\n}","import { getDatabase, runQuery, getAllQuery, logAction } from './database';\r\nimport axios from 'axios';\r\n\r\n// Import Feature Modules\r\nimport * as HunterEngine from './features/Hunter-engine';\r\nimport * as DocGenerator from './features/doc-generator';\r\nimport * as GhostJobNetwork from './features/ghost-job-network';\r\nimport * as SecretaryService from './features/secretary-service';\r\nimport { startHuntingScheduler as initScheduler } from './features/scheduler';\r\n\r\nlet huntingInterval: NodeJS.Timeout | null = null;\r\n\r\nexport async function callAI(model: any, prompt: string, fileData?: string): Promise<string> {\r\n  console.log('\\n----- CALL AI -----');\r\n  console.log('Model:', model?.model_name);\r\n  console.log('Prompt length:', prompt.length);\r\n  \r\n  try {\r\n    if (!model) {\r\n      console.log('‚ùå No model provided');\r\n      return \"Error: No AI model provided\";\r\n    }\r\n    \r\n    let apiKey = model.api_key ? model.api_key.trim() : '';\r\n    let modelName = model.model_name || 'gpt-3.5-turbo';\r\n    \r\n    // If no API key in model, try to find from database by role\r\n    if (!apiKey && model.role) {\r\n      console.log(`Looking for API key by role: ${model.role}`);\r\n      const models = await getAllQuery('SELECT * FROM ai_models');\r\n      const dbModel = models.find((m: any) => m.role === model.role && m.status === 'active');\r\n      if (dbModel) {\r\n        apiKey = dbModel.api_key?.trim() || '';\r\n        modelName = dbModel.model_name || modelName;\r\n        console.log(`Found model: ${modelName}, key: ${apiKey?.substring(0, 15)}...`);\r\n      }\r\n    }\r\n    \r\n    if (!apiKey) {\r\n      console.log('‚ùå No API key found');\r\n      return \"Error: No API key configured. Go to Settings > AI Models and add your API key.\";\r\n    }\r\n    \r\n    // Determine endpoint\r\n    let endpoint = 'https://api.openai.com/v1/chat/completions';\r\n    \r\n    if (model.model_type === 'local' || model.api_endpoint?.includes('localhost')) {\r\n      endpoint = model.api_endpoint || 'http://localhost:11434/v1/chat/completions';\r\n    } else if (apiKey.startsWith('tgp_v1_')) {\r\n      endpoint = 'https://api.together.xyz/v1/chat/completions';\r\n    }\r\n    \r\n    console.log('Endpoint:', endpoint);\r\n    console.log('Model name:', modelName);\r\n    \r\n    // Build request\r\n    const requestBody: any = {\r\n      model: modelName,\r\n      messages: [\r\n        { role: 'system', content: 'You are a helpful assistant that extracts job information. Always respond with valid JSON only.' },\r\n        { role: 'user', content: prompt }\r\n      ],\r\n      max_tokens: 1500,\r\n      temperature: 0.3\r\n    };\r\n    \r\n    // Add image if provided (for vision models)\r\n    if (fileData && modelName.includes('vision') || modelName.includes('gpt-4o')) {\r\n      requestBody.messages[1] = {\r\n        role: 'user',\r\n        content: [\r\n          { type: 'text', text: prompt },\r\n          { type: 'image_url', image_url: { url: fileData } }\r\n        ]\r\n      };\r\n    }\r\n    \r\n    console.log('Making API request...');\r\n    \r\n    const response = await axios.post(endpoint, requestBody, {\r\n      headers: { \r\n        'Authorization': `Bearer ${apiKey}`, \r\n        'Content-Type': 'application/json' \r\n      },\r\n      timeout: 60000\r\n    });\r\n    \r\n    const content = response.data.choices[0].message.content;\r\n    console.log('AI Response (first 500 chars):', content?.substring(0, 500));\r\n    console.log('----- END CALL AI -----\\n');\r\n    \r\n    return content;\r\n    \r\n  } catch (err: any) {\r\n    const errorMsg = err.response?.data?.error?.message || err.message;\r\n    console.log('‚ùå AI Error:', errorMsg);\r\n    console.log('Full error:', err.response?.data || err.message);\r\n    return \"Error: \" + errorMsg;\r\n  }\r\n}\r\n\r\nexport async function startHunterSearch(userId: number) {\r\n  console.log('startHunterSearch called with userId:', userId);\r\n  return await HunterEngine.startHunterSearch(userId, callAI);\r\n}\r\n\r\nexport async function analyzeJobUrl(jobId: number, userId: number, url: string) {\r\n  console.log('analyzeJobUrl called:', { jobId, userId, url });\r\n  const models = await getAllQuery('SELECT * FROM ai_models');\r\n  const hunter = models.find((m: any) => m.role === 'Hunter' && m.status === 'active');\r\n  const auditor = models.find((m: any) => m.role === 'Auditor' && m.status === 'active');\r\n  return await HunterEngine.analyzeJobUrl(jobId, userId, url, hunter, auditor || hunter, callAI);\r\n}\r\n\r\nexport async function processApplication(jobId: number, userId: number, userConsentGiven: boolean = false) {\r\n  try {\r\n    const db = getDatabase();\r\n    const job = db.job_listings.find((j: any) => j.id === jobId);\r\n    if (!job) return { success: false, error: 'Job not found' };\r\n    const models = await getAllQuery('SELECT * FROM ai_models');\r\n    const thinker = models.find((m: any) => m.role === 'Thinker' && m.status === 'active');\r\n    const auditor = models.find((m: any) => m.role === 'Auditor' && m.status === 'active');\r\n    if (thinker && auditor) {\r\n      await DocGenerator.generateTailoredDocs(job, thinker, auditor, { cv: true, coverLetter: true }, callAI);\r\n    }\r\n    return { success: true };\r\n  } catch (error: any) {\r\n    return { success: false, error: error.message };\r\n  }\r\n}\r\n\r\nexport function startHuntingScheduler(userId: number) {\r\n  if (huntingInterval) clearInterval(huntingInterval);\r\n  huntingInterval = initScheduler(userId, startHunterSearch, callAI);\r\n}","import puppeteer, { Browser, Page } from 'puppeteer';\r\nimport { logAction } from './database';\r\nimport path from 'path';\r\nimport { app } from 'electron';\r\n\r\nlet activeBrowser: Browser | null = null;\r\n\r\n// Get persistent user data directory for session cookies\r\nconst getUserDataDir = () => {\r\n  return path.join(app.getPath('userData'), 'browser_data');\r\n};\r\n\r\n/**\r\n * Random delay to simulate human behavior\r\n */\r\nfunction randomDelay(min: number, max: number): Promise<void> {\r\n  const delay = Math.floor(Math.random() * (max - min + 1)) + min;\r\n  return new Promise(resolve => setTimeout(resolve, delay));\r\n}\r\n\r\n/**\r\n * COOKIE BANNER BYPASS\r\n */\r\nasync function handleCookieRoadblock(page: Page, userId: number, callAI: Function) {\r\n  try {\r\n    const isBannerVisible = await page.evaluate(() => {\r\n      const text = document.body.innerText.toLowerCase();\r\n      return text.includes('cookie') || text.includes('accept') || text.includes('agree') || text.includes('zustimmen') || text.includes('akzeptieren');\r\n    });\r\n    \r\n    if (!isBannerVisible) return;\r\n\r\n    await logAction(userId, 'ai_observer', 'üì∏ Cookie banner detected. Attempting bypass...', 'in_progress');\r\n    \r\n    // Try DOM-based click first (faster & more reliable)\r\n    const clicked = await page.evaluate(() => {\r\n      const selectors = [\r\n        'button[data-testid=\"cookie-policy-dialog-accept-button\"]',\r\n        'button[id*=\"reject\"]', 'button[id*=\"decline\"]', 'button[id*=\"ablehnen\"]',\r\n        'button[class*=\"reject\"]', 'button[class*=\"decline\"]',\r\n        '[data-tracking-control-name*=\"cookie\"]',\r\n        'button.artdeco-button--secondary'\r\n      ];\r\n      \r\n      for (const sel of selectors) {\r\n        const btn = document.querySelector(sel) as HTMLElement;\r\n        if (btn) { btn.click(); return true; }\r\n      }\r\n      \r\n      // Fallback: find by text content\r\n      const btns = Array.from(document.querySelectorAll('button, a, div[role=\"button\"]'));\r\n      const rejectBtn = btns.find(b => {\r\n        const txt = b.textContent?.toLowerCase() || '';\r\n        return txt.includes('reject') || txt.includes('decline') || txt.includes('ablehnen') || txt.includes('nur notwendige') || txt.includes('essential');\r\n      });\r\n      if (rejectBtn) { (rejectBtn as HTMLElement).click(); return true; }\r\n      \r\n      // Last resort: accept\r\n      const acceptBtn = btns.find(b => {\r\n        const txt = b.textContent?.toLowerCase() || '';\r\n        return txt.includes('accept') || txt.includes('agree') || txt.includes('akzeptieren') || txt.includes('alle akzeptieren');\r\n      });\r\n      if (acceptBtn) { (acceptBtn as HTMLElement).click(); return true; }\r\n      \r\n      return false;\r\n    });\r\n\r\n    if (clicked) {\r\n      await logAction(userId, 'ai_observer', '‚úÖ Cookie banner dismissed', 'completed', true);\r\n      await randomDelay(1500, 2500);\r\n    }\r\n  } catch (e) {\r\n    console.log('Cookie bypass error:', e);\r\n  }\r\n}\r\n\r\n/**\r\n * Check if page is blocked by bot detection\r\n */\r\nasync function isPageBlocked(page: Page): Promise<boolean> {\r\n  return await page.evaluate(() => {\r\n    const text = document.body.innerText.toLowerCase();\r\n    return text.includes('verify you are human') || \r\n           text.includes('captcha') || \r\n           text.includes('unusual traffic') ||\r\n           text.includes('sign in to view') ||\r\n           text.includes('please verify') ||\r\n           text.includes('robot') ||\r\n           text.includes('blocked');\r\n  });\r\n}\r\n\r\n/**\r\n * SCRAPING - GET JOB PAGE CONTENT\r\n * Tries multiple extraction strategies\r\n */\r\nexport async function getJobPageContent(url: string, userId: number, callAI: Function): Promise<{ content: string, strategyUsed: string }> {\r\n  let browser: Browser | null = null;\r\n  \r\n  try {\r\n    console.log(`Scraper: Opening ${url}`);\r\n    \r\n    browser = await puppeteer.launch({ \r\n      headless: false,\r\n      userDataDir: getUserDataDir(),\r\n      args: [\r\n        '--no-sandbox', \r\n        '--disable-setuid-sandbox', \r\n        '--disable-blink-features=AutomationControlled',\r\n        '--disable-infobars',\r\n        '--window-size=1280,800'\r\n      ] \r\n    });\r\n    \r\n    const page = await browser.newPage();\r\n    \r\n    // Stealth settings\r\n    await page.setViewport({ width: 1280, height: 800 });\r\n    await page.setUserAgent('Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36');\r\n    \r\n    // Hide webdriver property\r\n    await page.evaluateOnNewDocument(() => {\r\n      Object.defineProperty(navigator, 'webdriver', { get: () => false });\r\n      Object.defineProperty(navigator, 'plugins', { get: () => [1, 2, 3, 4, 5] });\r\n      Object.defineProperty(navigator, 'languages', { get: () => ['en-US', 'en', 'de'] });\r\n    });\r\n    \r\n    await page.goto(url, { waitUntil: 'networkidle2', timeout: 60000 });\r\n    \r\n    // Handle cookie banner\r\n    await handleCookieRoadblock(page, userId, callAI);\r\n    \r\n    // Human-like scrolling\r\n    await page.evaluate(() => window.scrollBy(0, 300));\r\n    await randomDelay(800, 1500);\r\n    await page.evaluate(() => window.scrollBy(0, 400));\r\n    await randomDelay(1500, 3000);\r\n\r\n    // Check if blocked\r\n    if (await isPageBlocked(page)) {\r\n      console.log('Scraper: Page blocked by bot detection');\r\n      return { content: '', strategyUsed: 'Blocked' };\r\n    }\r\n\r\n    // Try extraction strategies in order\r\n    const result = await page.evaluate(() => {\r\n      const getCleanText = (el: Element | null) => el ? (el as HTMLElement).innerText.replace(/\\s+/g, ' ').trim() : '';\r\n      \r\n      // STRATEGY 1: JSON-LD (Most reliable - structured data)\r\n      const jsonLdScripts = document.querySelectorAll('script[type=\"application/ld+json\"]');\r\n      for (const script of jsonLdScripts) {\r\n        try {\r\n          const data = JSON.parse(script.textContent || '');\r\n          // Check if it's a JobPosting\r\n          if (data['@type'] === 'JobPosting' || data.title || data.jobTitle) {\r\n            console.log('Found JSON-LD JobPosting');\r\n            return { content: JSON.stringify(data, null, 2), strategy: 'JSON-LD' };\r\n          }\r\n          // Check for array format\r\n          if (Array.isArray(data)) {\r\n            const job = data.find((item: any) => item['@type'] === 'JobPosting');\r\n            if (job) {\r\n              return { content: JSON.stringify(job, null, 2), strategy: 'JSON-LD' };\r\n            }\r\n          }\r\n          // Check for @graph format\r\n          if (data['@graph']) {\r\n            const job = data['@graph'].find((item: any) => item['@type'] === 'JobPosting');\r\n            if (job) {\r\n              return { content: JSON.stringify(job, null, 2), strategy: 'JSON-LD' };\r\n            }\r\n          }\r\n        } catch (e) {}\r\n      }\r\n      \r\n      // STRATEGY 2: Job-specific selectors\r\n      const jobSelectors = [\r\n        '.job-description', \r\n        '#jobDescriptionText', \r\n        '.description__text', \r\n        '.show-more-less-html__markup', \r\n        '.jobs-description__content',\r\n        '.jobs-box__html-content',\r\n        '[data-testid=\"job-description\"]', \r\n        '.job-details',\r\n        '.jobsearch-JobComponent-description',\r\n        '#job-details'\r\n      ];\r\n      \r\n      for (const sel of jobSelectors) {\r\n        const el = document.querySelector(sel);\r\n        if (el && el.textContent && el.textContent.length > 300) {\r\n          return { content: getCleanText(el), strategy: `Selector: ${sel}` };\r\n        }\r\n      }\r\n      \r\n      // STRATEGY 3: Semantic HTML tags\r\n      const semanticEls = document.querySelectorAll('main, article, [role=\"main\"]');\r\n      for (const el of semanticEls) {\r\n        if (el.textContent && el.textContent.length > 500) {\r\n          return { content: getCleanText(el), strategy: 'Semantic' };\r\n        }\r\n      }\r\n      \r\n      // STRATEGY 4: Find largest content block\r\n      const divs = Array.from(document.querySelectorAll('div, section'));\r\n      const blocks = divs\r\n        .map(el => ({ el, text: getCleanText(el), len: el.textContent?.length || 0 }))\r\n        .filter(b => b.len > 500 && b.len < 50000)\r\n        .sort((a, b) => b.len - a.len);\r\n      \r\n      if (blocks.length > 0) {\r\n        return { content: blocks[0].text, strategy: 'Density' };\r\n      }\r\n\r\n      // STRATEGY 5: Full body (last resort)\r\n      const bodyText = getCleanText(document.body);\r\n      if (bodyText.length > 300) {\r\n        return { content: bodyText.substring(0, 15000), strategy: 'Body' };\r\n      }\r\n      \r\n      return { content: '', strategy: 'Empty' };\r\n    });\r\n\r\n    console.log(`Scraper: Extracted using ${result.strategy}, length: ${result.content.length}`);\r\n    return { content: result.content, strategyUsed: result.strategy };\r\n    \r\n  } catch (error: any) {\r\n    console.error('Scraper Error:', error.message);\r\n    return { content: '', strategyUsed: 'Failed: ' + error.message };\r\n  } finally {\r\n    if (browser) {\r\n      await browser.close();\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * SCRAPE JOB LISTING URLS FROM SEARCH RESULTS\r\n */\r\nexport async function scrapeJobs(baseUrl: string, query: string, location: string, credentials?: any, userId?: number, callAI?: Function): Promise<string[]> {\r\n  let browser: Browser | null = null;\r\n  const jobUrls: string[] = [];\r\n  \r\n  try {\r\n    console.log(`Scraper: Searching for \"${query}\" in \"${location}\" on ${baseUrl}`);\r\n    \r\n    browser = await puppeteer.launch({ \r\n      headless: false, \r\n      userDataDir: getUserDataDir(),\r\n      args: [\r\n        '--no-sandbox', \r\n        '--disable-setuid-sandbox', \r\n        '--disable-blink-features=AutomationControlled',\r\n        '--disable-infobars',\r\n        '--start-maximized'\r\n      ] \r\n    });\r\n    \r\n    const page = await browser.newPage();\r\n    await page.setViewport({ width: 1280, height: 800 });\r\n    await page.setUserAgent('Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36');\r\n    \r\n    // Hide webdriver\r\n    await page.evaluateOnNewDocument(() => {\r\n      Object.defineProperty(navigator, 'webdriver', { get: () => false });\r\n    });\r\n    \r\n    // Build search URL based on website\r\n    let searchUrl: string;\r\n    if (baseUrl.includes('linkedin.com')) {\r\n      searchUrl = `https://www.linkedin.com/jobs/search/?keywords=${encodeURIComponent(query)}&location=${encodeURIComponent(location)}`;\r\n    } else if (baseUrl.includes('indeed')) {\r\n      searchUrl = `https://de.indeed.com/jobs?q=${encodeURIComponent(query)}&l=${encodeURIComponent(location)}`;\r\n    } else if (baseUrl.includes('glassdoor')) {\r\n      searchUrl = `https://www.glassdoor.com/Job/jobs.htm?sc.keyword=${encodeURIComponent(query)}&locT=C&locKeyword=${encodeURIComponent(location)}`;\r\n    } else if (baseUrl.includes('xing')) {\r\n      searchUrl = `https://www.xing.com/jobs/search?keywords=${encodeURIComponent(query)}&location=${encodeURIComponent(location)}`;\r\n    } else {\r\n      searchUrl = baseUrl;\r\n    }\r\n    \r\n    console.log(`Scraper: Navigating to ${searchUrl}`);\r\n    await page.goto(searchUrl, { waitUntil: 'networkidle2', timeout: 60000 });\r\n    \r\n    // Handle cookies\r\n    if (callAI && userId) {\r\n      await handleCookieRoadblock(page, userId, callAI);\r\n    }\r\n    \r\n    // Human-like behavior - wait and scroll\r\n    await randomDelay(2000, 4000);\r\n    await page.evaluate(() => window.scrollBy(0, 400));\r\n    await randomDelay(1000, 2000);\r\n    await page.evaluate(() => window.scrollBy(0, 400));\r\n    await randomDelay(2000, 4000);\r\n    \r\n    // Check if blocked\r\n    if (await isPageBlocked(page)) {\r\n      console.log('Scraper: Search page blocked');\r\n      if (userId) {\r\n        await logAction(userId, 'ai_hunter', 'üö´ Search page blocked by bot detection', 'failed', false);\r\n      }\r\n      return [];\r\n    }\r\n    \r\n    // Extract job URLs\r\n    const links = await page.evaluate(() => {\r\n      const selectors = [\r\n        // LinkedIn\r\n        'a.job-card-container__link',\r\n        'a.base-card__full-link',\r\n        'a[data-tracking-control-name=\"public_jobs_jserp-result_search-card\"]',\r\n        '.jobs-search__results-list a',\r\n        // Indeed\r\n        'a.jcs-JobTitle',\r\n        'h2.jobTitle a',\r\n        '.job_seen_beacon a[data-jk]',\r\n        '.jobsearch-ResultsList a.tapItem',\r\n        // Glassdoor\r\n        'a.job-title',\r\n        '.react-job-listing a',\r\n        // Xing\r\n        'a[data-testid=\"job-posting-link\"]',\r\n        '.jobs-list a',\r\n        // Generic\r\n        'a[href*=\"/job/\"]',\r\n        'a[href*=\"/jobs/\"]',\r\n        'a[href*=\"jobPosting\"]'\r\n      ];\r\n      \r\n      const foundLinks: string[] = [];\r\n      \r\n      selectors.forEach(selector => {\r\n        document.querySelectorAll(selector).forEach(el => {\r\n          const href = (el as HTMLAnchorElement).href;\r\n          if (href && \r\n              href.startsWith('http') && \r\n              !foundLinks.includes(href) &&\r\n              !href.includes('/login') &&\r\n              !href.includes('/signup') &&\r\n              !href.includes('/register')) {\r\n            foundLinks.push(href);\r\n          }\r\n        });\r\n      });\r\n      \r\n      return foundLinks;\r\n    });\r\n    \r\n    // Limit to first 15 unique URLs\r\n    const uniqueLinks = [...new Set(links)].slice(0, 15);\r\n    jobUrls.push(...uniqueLinks);\r\n    \r\n    console.log(`Scraper: Found ${jobUrls.length} job URLs`);\r\n    \r\n  } catch (error: any) { \r\n    console.error('Scraper Error:', error.message); \r\n  } finally { \r\n    if (browser) {\r\n      await browser.close();\r\n    }\r\n  }\r\n  \r\n  return jobUrls;\r\n}\r\n\r\n/**\r\n * Open browser for manual login warm-up\r\n */\r\nexport async function openLinkedIn(userId: number, url: string) {\r\n  activeBrowser = await puppeteer.launch({ \r\n    headless: false, \r\n    userDataDir: getUserDataDir(),\r\n    defaultViewport: null, \r\n    args: ['--start-maximized'] \r\n  });\r\n  const page = await activeBrowser.newPage();\r\n  await page.goto(url, { waitUntil: 'domcontentloaded' });\r\n  return { success: true };\r\n}","import { runQuery, getDatabase, getAllQuery, logAction } from '../database';\r\nimport { scrapeJobs, getJobPageContent } from '../scraper-service';\r\nimport { reportGhostJob } from './ghost-job-network';\r\n\r\nexport async function analyzeJobUrl(jobId: number, userId: number, url: string, hunter: any, auditor: any, callAI: Function) {\r\n  console.log(`\\n========== ANALYZING JOB ${jobId} ==========`);\r\n  console.log(`URL: ${url}`);\r\n  console.log(`Hunter model:`, hunter ? hunter.model_name : 'MISSING!');\r\n  \r\n  await logAction(userId, 'ai_hunter', `üîç Analyzing: ${url}`, 'in_progress');\r\n  \r\n  // Step 1: Get page content\r\n  console.log('Step 1: Getting page content...');\r\n  const pageData = await getJobPageContent(url, userId, callAI);\r\n  \r\n  console.log(`Scraper result: strategy=\"${pageData.strategyUsed}\", contentLength=${pageData.content.length}`);\r\n  \r\n  // Check if blocked or failed\r\n  if (pageData.strategyUsed.includes('Blocked') || pageData.strategyUsed.includes('Failed')) {\r\n    console.log('‚ùå Page was blocked or failed');\r\n    await logAction(userId, 'ai_auditor', `‚ùå Blocked: ${url}`, 'failed', false);\r\n    await runQuery('DELETE FROM job_listings', { id: jobId });\r\n    return;\r\n  }\r\n\r\n  // Check minimum content\r\n  if (!pageData.content || pageData.content.length < 100) {\r\n    console.log('‚ùå Content too short:', pageData.content.length);\r\n    await logAction(userId, 'ai_auditor', `‚ùå Empty content: ${url}`, 'failed', false);\r\n    await runQuery('DELETE FROM job_listings', { id: jobId });\r\n    return;\r\n  }\r\n\r\n  console.log('‚úÖ Got content, first 500 chars:', pageData.content.substring(0, 500));\r\n  await logAction(userId, 'ai_hunter', `üìÑ Got ${pageData.content.length} chars via ${pageData.strategyUsed}`, 'in_progress');\r\n\r\n  // Step 2: Check if we have a valid Hunter AI model\r\n  if (!hunter || !hunter.api_key) {\r\n    console.log('‚ùå No Hunter AI model or missing API key!');\r\n    await logAction(userId, 'ai_hunter', `‚ùå No Hunter AI configured!`, 'failed', false);\r\n    \r\n    // FALLBACK: Try to extract basic info without AI\r\n    console.log('Attempting fallback extraction...');\r\n    const fallbackData = extractBasicInfo(pageData.content, url);\r\n    if (fallbackData.jobTitle) {\r\n      await runQuery('UPDATE job_listings', { \r\n        id: jobId, \r\n        ...fallbackData,\r\n        status: 'analyzed', \r\n        date_imported: new Date().toLocaleDateString() \r\n      });\r\n      console.log('‚úÖ Saved with fallback data:', fallbackData);\r\n    }\r\n    return;\r\n  }\r\n\r\n  // Step 3: Build prompt for AI\r\n  const isJsonLd = pageData.strategyUsed.includes('JSON-LD');\r\n  console.log('Is JSON-LD:', isJsonLd);\r\n  \r\n  let prompt: string;\r\n  if (isJsonLd) {\r\n    prompt = `You are a job data extractor. Extract job details from this JSON-LD data.\r\n\r\nReturn ONLY a valid JSON object (no markdown, no explanation):\r\n{\"jobTitle\":\"exact job title\",\"companyName\":\"company name\",\"location\":\"city, country\",\"jobType\":\"Full-time/Part-time/Contract\",\"experienceLevel\":\"Junior/Mid/Senior\",\"salaryRange\":\"salary or N/A\",\"description\":\"2-3 sentence summary\",\"requiredSkills\":\"comma separated\",\"remoteOnsite\":\"Remote/Hybrid/Onsite\"}\r\n\r\nJSON-LD:\r\n${pageData.content.substring(0, 6000)}`;\r\n  } else {\r\n    prompt = `You are a job data extractor. Extract job details from this job listing text.\r\n\r\nReturn ONLY a valid JSON object (no markdown, no explanation):\r\n{\"jobTitle\":\"exact job title\",\"companyName\":\"company name\",\"location\":\"city, country\",\"jobType\":\"Full-time/Part-time/Contract\",\"experienceLevel\":\"Junior/Mid/Senior\",\"salaryRange\":\"salary or N/A\",\"description\":\"2-3 sentence summary\",\"requiredSkills\":\"comma separated\",\"remoteOnsite\":\"Remote/Hybrid/Onsite\"}\r\n\r\nJob listing:\r\n${pageData.content.substring(0, 6000)}`;\r\n  }\r\n\r\n  console.log('Step 3: Calling AI...');\r\n  console.log('Prompt length:', prompt.length);\r\n  \r\n  // Step 4: Call AI\r\n  let aiResponse: string;\r\n  try {\r\n    aiResponse = await callAI(hunter, prompt);\r\n    console.log('AI Response:', aiResponse);\r\n  } catch (aiError: any) {\r\n    console.log('‚ùå AI call failed:', aiError.message);\r\n    await logAction(userId, 'ai_hunter', `‚ùå AI error: ${aiError.message}`, 'failed', false);\r\n    \r\n    // Try fallback\r\n    const fallbackData = extractBasicInfo(pageData.content, url);\r\n    if (fallbackData.jobTitle) {\r\n      await runQuery('UPDATE job_listings', { id: jobId, ...fallbackData, status: 'analyzed', date_imported: new Date().toLocaleDateString() });\r\n    } else {\r\n      await runQuery('UPDATE job_listings', { id: jobId, status: 'manual_review' });\r\n    }\r\n    return;\r\n  }\r\n\r\n  // Check for AI errors in response\r\n  if (aiResponse.toLowerCase().includes('error:') || aiResponse.toLowerCase().includes('invalid api')) {\r\n    console.log('‚ùå AI returned error:', aiResponse);\r\n    await logAction(userId, 'ai_hunter', `‚ùå AI error: ${aiResponse.substring(0, 100)}`, 'failed', false);\r\n    await runQuery('UPDATE job_listings', { id: jobId, status: 'manual_review' });\r\n    return;\r\n  }\r\n\r\n  // Step 5: Parse AI response\r\n  console.log('Step 5: Parsing AI response...');\r\n  try {\r\n    // Clean the response\r\n    let cleanedResponse = aiResponse\r\n      .replace(/```json/gi, '')\r\n      .replace(/```/g, '')\r\n      .replace(/^[^{]*/, '')  // Remove anything before first {\r\n      .replace(/[^}]*$/, '')  // Remove anything after last }\r\n      .trim();\r\n    \r\n    // Try to find JSON\r\n    const jsonMatch = cleanedResponse.match(/\\{[\\s\\S]*\\}/);\r\n    if (!jsonMatch) {\r\n      console.log('‚ùå No JSON found in response');\r\n      throw new Error('No JSON in response');\r\n    }\r\n    \r\n    const data = JSON.parse(jsonMatch[0]);\r\n    console.log('Parsed data:', data);\r\n    \r\n    // Validate required fields\r\n    const jobTitle = data.jobTitle || data.title || data.job_title || '';\r\n    const companyName = data.companyName || data.company || data.company_name || data.hiringOrganization?.name || '';\r\n    \r\n    if (!jobTitle || jobTitle.toLowerCase() === 'n/a' || jobTitle.toLowerCase() === 'unknown') {\r\n      console.log('‚ùå Missing job title');\r\n      await logAction(userId, 'ai_auditor', `‚ùå Missing job title`, 'failed', false);\r\n      const fallbackData = extractBasicInfo(pageData.content, url);\r\n      if (fallbackData.jobTitle) {\r\n        await runQuery('UPDATE job_listings', { id: jobId, ...fallbackData, status: 'analyzed', date_imported: new Date().toLocaleDateString() });\r\n      } else {\r\n        await runQuery('DELETE FROM job_listings', { id: jobId });\r\n      }\r\n      return;\r\n    }\r\n\r\n    // Step 6: Save to database\r\n    console.log('Step 6: Saving to database...');\r\n    const updateData = {\r\n      id: jobId,\r\n      job_title: jobTitle,\r\n      company_name: companyName || 'Unknown Company',\r\n      location: data.location || data.jobLocation || 'N/A',\r\n      job_type: data.jobType || data.employmentType || 'N/A',\r\n      experience_level: data.experienceLevel || 'N/A',\r\n      salary_range: data.salaryRange || data.salary || data.baseSalary || 'N/A',\r\n      description: data.description || '',\r\n      required_skills: data.requiredSkills || data.skills || 'N/A',\r\n      remote_onsite: data.remoteOnsite || data.jobLocationType || 'N/A',\r\n      posted_date: data.postedDate || data.datePosted || 'N/A',\r\n      application_url: data.applicationUrl || data.url || url,\r\n      status: 'analyzed',\r\n      date_imported: new Date().toLocaleDateString()\r\n    };\r\n    \r\n    console.log('Update data:', updateData);\r\n    await runQuery('UPDATE job_listings', updateData);\r\n    \r\n    await logAction(userId, 'ai_auditor', `‚úÖ Extracted: ${jobTitle} at ${companyName}`, 'completed', true);\r\n    console.log(`‚úÖ SUCCESS: ${jobTitle} at ${companyName}`);\r\n    \r\n  } catch (parseError: any) {\r\n    console.log('‚ùå Parse error:', parseError.message);\r\n    await logAction(userId, 'ai_auditor', `‚ùå Parse failed`, 'failed', false);\r\n    \r\n    // Final fallback\r\n    const fallbackData = extractBasicInfo(pageData.content, url);\r\n    if (fallbackData.jobTitle) {\r\n      await runQuery('UPDATE job_listings', { id: jobId, ...fallbackData, status: 'analyzed', date_imported: new Date().toLocaleDateString() });\r\n      console.log('‚úÖ Saved with fallback:', fallbackData);\r\n    } else {\r\n      await runQuery('UPDATE job_listings', { id: jobId, status: 'manual_review' });\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * FALLBACK: Extract basic info without AI\r\n */\r\nfunction extractBasicInfo(content: string, url: string): any {\r\n  console.log('Running fallback extraction...');\r\n  \r\n  const data: any = {\r\n    application_url: url\r\n  };\r\n  \r\n  // Try to extract from JSON-LD\r\n  try {\r\n    if (content.startsWith('{')) {\r\n      const json = JSON.parse(content);\r\n      data.job_title = json.title || json.jobTitle || json.name || '';\r\n      data.company_name = json.hiringOrganization?.name || json.companyName || json.company || '';\r\n      data.location = json.jobLocation?.address?.addressLocality || json.location || '';\r\n      data.job_type = json.employmentType || '';\r\n      data.description = json.description?.substring(0, 500) || '';\r\n      console.log('Extracted from JSON:', data);\r\n      return data;\r\n    }\r\n  } catch (e) {}\r\n  \r\n  // Try regex patterns on text\r\n  const lines = content.split('\\n').map(l => l.trim()).filter(l => l);\r\n  \r\n  // Job title is often in first few lines or after specific keywords\r\n  for (const line of lines.slice(0, 10)) {\r\n    if (line.length > 5 && line.length < 100 && !line.includes('cookie') && !line.includes('Sign')) {\r\n      if (!data.job_title) {\r\n        data.job_title = line;\r\n        break;\r\n      }\r\n    }\r\n  }\r\n  \r\n  // Look for company name patterns\r\n  const companyPatterns = [\r\n    /(?:at|@|by|company[:\\s]+)([A-Z][A-Za-z0-9\\s&.-]+)/i,\r\n    /([A-Z][A-Za-z0-9\\s&.-]+)(?:\\s+is hiring|\\s+jobs)/i\r\n  ];\r\n  \r\n  for (const pattern of companyPatterns) {\r\n    const match = content.match(pattern);\r\n    if (match && match[1]) {\r\n      data.company_name = match[1].trim();\r\n      break;\r\n    }\r\n  }\r\n  \r\n  // Location patterns\r\n  const locationPatterns = [\r\n    /(?:location|located in|based in)[:\\s]+([A-Za-z\\s,]+)/i,\r\n    /(Berlin|Munich|Hamburg|Frankfurt|London|Paris|Amsterdam|Remote)/i\r\n  ];\r\n  \r\n  for (const pattern of locationPatterns) {\r\n    const match = content.match(pattern);\r\n    if (match && match[1]) {\r\n      data.location = match[1].trim();\r\n      break;\r\n    }\r\n  }\r\n  \r\n  console.log('Fallback extracted:', data);\r\n  return data;\r\n}\r\n\r\nexport async function startHunterSearch(userId: number, callAI: Function) {\r\n  console.log('\\n========== STARTING HUNTER SEARCH ==========');\r\n  \r\n  try {\r\n    await logAction(userId, 'ai_hunter', 'üöÄ Starting job hunt...', 'in_progress');\r\n    \r\n    const db = getDatabase();\r\n    const profiles = db.search_profiles.filter((p: any) => p.is_active === 1);\r\n    const websites = db.job_websites.filter((w: any) => w.is_active === 1);\r\n    const models = await getAllQuery('SELECT * FROM ai_models');\r\n    \r\n    console.log('Search profiles:', profiles.length);\r\n    console.log('Job websites:', websites.length);\r\n    console.log('AI models:', models.length);\r\n    \r\n    const hunter = models.find((m: any) => m.role === 'Hunter' && m.status === 'active');\r\n    const auditor = models.find((m: any) => m.role === 'Auditor' && m.status === 'active');\r\n\r\n    console.log('Hunter:', hunter ? `${hunter.model_name} (key: ${hunter.api_key?.substring(0, 10)}...)` : 'NOT FOUND');\r\n    console.log('Auditor:', auditor ? auditor.model_name : 'NOT FOUND (will use Hunter)');\r\n\r\n    if (!hunter) {\r\n      const errorMsg = 'No active Hunter AI model. Go to Settings > AI Models and add one with role \"Hunter\".';\r\n      console.log('‚ùå', errorMsg);\r\n      await logAction(userId, 'ai_hunter', `‚ùå ${errorMsg}`, 'failed', false);\r\n      return { success: false, error: errorMsg };\r\n    }\r\n    \r\n    if (profiles.length === 0) {\r\n      const errorMsg = 'No active search profiles. Go to Search Profiles and create one.';\r\n      console.log('‚ùå', errorMsg);\r\n      await logAction(userId, 'ai_hunter', `‚ùå ${errorMsg}`, 'failed', false);\r\n      return { success: false, error: errorMsg };\r\n    }\r\n    \r\n    if (websites.length === 0) {\r\n      const errorMsg = 'No active job websites. Go to Job Websites and add one.';\r\n      console.log('‚ùå', errorMsg);\r\n      await logAction(userId, 'ai_hunter', `‚ùå ${errorMsg}`, 'failed', false);\r\n      return { success: false, error: errorMsg };\r\n    }\r\n\r\n    let totalJobsFound = 0;\r\n\r\n    for (const profile of profiles) {\r\n      console.log(`\\nProfile: ${profile.job_title} in ${profile.location}`);\r\n      \r\n      for (const website of websites) {\r\n        console.log(`Website: ${website.website_name} (${website.website_url})`);\r\n        \r\n        await logAction(userId, 'ai_hunter', `üåê Searching ${website.website_name}...`, 'in_progress');\r\n        \r\n        // Simple search query (don't waste AI tokens on this)\r\n        const query = profile.job_title;\r\n        console.log(`Search query: \"${query}\"`);\r\n        \r\n        // Scrape job URLs\r\n        const jobUrls = await scrapeJobs(\r\n          website.website_url, \r\n          query, \r\n          profile.location || '', \r\n          { email: website.email, password: website.password }, \r\n          userId, \r\n          callAI\r\n        );\r\n        \r\n        console.log(`Found ${jobUrls.length} URLs`);\r\n        await logAction(userId, 'ai_hunter', `üì• Found ${jobUrls.length} jobs on ${website.website_name}`, 'completed', true);\r\n        \r\n        // Process each URL\r\n        for (const url of jobUrls) {\r\n          // Skip duplicates\r\n          const existing = db.job_listings.find((j: any) => j.url === url);\r\n          if (existing) {\r\n            console.log(`Skipping duplicate: ${url}`);\r\n            continue;\r\n          }\r\n          \r\n          // Create job entry\r\n          const jobId = Date.now() + Math.floor(Math.random() * 1000);\r\n          await runQuery('INSERT INTO job_listings', { \r\n            id: jobId, \r\n            url, \r\n            source: website.website_name, \r\n            status: 'analyzing' \r\n          });\r\n          \r\n          totalJobsFound++;\r\n          console.log(`Added job ${jobId}: ${url}`);\r\n          \r\n          // Analyze immediately (wait for it to complete)\r\n          await analyzeJobUrl(jobId, userId, url, hunter, auditor || hunter, callAI);\r\n          \r\n          // Small delay\r\n          await new Promise(resolve => setTimeout(resolve, 2000));\r\n        }\r\n      }\r\n    }\r\n    \r\n    await logAction(userId, 'ai_hunter', `‚úÖ Done! Processed ${totalJobsFound} jobs.`, 'completed', true);\r\n    console.log(`\\n========== HUNT COMPLETE: ${totalJobsFound} jobs ==========\\n`);\r\n    return { success: true, jobsFound: totalJobsFound };\r\n    \r\n  } catch (error: any) { \r\n    console.error('Hunt error:', error);\r\n    await logAction(userId, 'ai_hunter', `‚ùå Error: ${error.message}`, 'failed', false);\r\n    return { success: false, error: error.message }; \r\n  }\r\n}","import { runQuery } from '../database';\r\n\r\nexport async function generateTailoredDocs(job: any, thinker: any, auditor: any, options: any, callAI: Function) {\r\n  const docTypes = [\r\n    { key: 'cv', label: 'CV' },\r\n    { key: 'motivation_letter', label: 'Motivation Letter' },\r\n    { key: 'portfolio', label: 'Portfolio' },\r\n    { key: 'proposal', label: 'Proposal' },\r\n    { key: 'cover_letter', label: 'Cover Letter' }\r\n  ];\r\n\r\n  for (const type of docTypes) {\r\n    const optionKey = type.key === 'motivation_letter' ? 'motivationLetter' : type.key;\r\n    if (options[optionKey]) {\r\n      try {\r\n        await runQuery('UPDATE job_listings', { id: job.id, [`${type.key}_status`]: 'generating' });\r\n        const genPrompt = `Generate a tailored ${type.label} for: ${job.job_title} at ${job.company_name}. \\nJob Description: ${job.description}`;\r\n        const content = await callAI(thinker, genPrompt);\r\n        await runQuery('UPDATE job_listings', { id: job.id, [`${type.key}_status`]: 'thinker_done' });\r\n        const auditResult = await callAI(auditor, `Review this ${type.label}: ${content}. Answer APPROVED or REJECT.`);\r\n        if (auditResult.toUpperCase().includes('APPROVED')) {\r\n          await runQuery('UPDATE job_listings', { id: job.id, [`${type.key}_status`]: 'auditor_done' });\r\n        } else {\r\n          await runQuery('UPDATE job_listings', { id: job.id, [`${type.key}_status`]: 'failed' });\r\n        }\r\n      } catch (e) {\r\n        await runQuery('UPDATE job_listings', { id: job.id, [`${type.key}_status`]: 'failed' });\r\n      }\r\n    }\r\n  }\r\n}","import { getDatabase, runQuery } from '../database';\r\n\r\nexport function startHuntingScheduler(userId: number, startHunterSearch: Function, callAI: Function) {\r\n  return setInterval(async () => {\r\n    const db = getDatabase();\r\n    const websites = db.job_websites.filter((w: any) => w.is_active === 1);\r\n    const now = new Date();\r\n    for (const website of websites) {\r\n      const lastChecked = website.last_checked ? new Date(website.last_checked) : new Date(0);\r\n      const hoursSinceLastCheck = (now.getTime() - lastChecked.getTime()) / (1000 * 60 * 60);\r\n      const frequency = website.site_type === 'career_page' ? 24 : (website.check_frequency || 4);\r\n      if (hoursSinceLastCheck >= frequency) {\r\n        await startHunterSearch(userId, callAI);\r\n        await runQuery('UPDATE job_websites', { id: website.id, last_checked: now.toISOString() });\r\n      }\r\n    }\r\n  }, 60000);\r\n}"],"mappings":"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","names":["import_electron","import_path","path","fs","import_electron","import_path","import_electron","path","callAI","puppeteer","callAI","callAI","startHunterSearch","callAI","axios","startHunterSearch","analyzeJobUrl","startHuntingScheduler","import_axios","analyzeJobUrl","startHunterSearch","axios","startHuntingScheduler","path","isDev"]}